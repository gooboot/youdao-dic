# 有道词典音频下载器

## 功能说明

这个Python脚本可以批量下载有道词典中单词的音频文件，支持英式和美式发音。

## 目录结构

```
~/Desktop/myNote/
├── split_words/          # 分割后的单词文件目录
├── audio_downloads/      # 音频文件下载目录
├── download_progress.json # 下载进度记录文件
├── download_audio.py     # 音频下载脚本
└── README_audio_downloader.md # 使用说明
```

## 使用方法

### 1. 查看当前状态

#### 详细状态（显示所有文件的进度条）
```bash
cd ~/Desktop/myNote
python3 download_audio.py --status
```

#### 简洁状态（显示概要信息）
```bash
python3 download_audio.py --brief
```

### 2. 下载音频（默认处理1个文件）
```bash
python3 download_audio.py
```

### 3. 指定处理文件数量
```bash
# 处理3个文件
python3 download_audio.py --num 3

# 或者使用短参数
python3 download_audio.py -n 5
```

### 4. 指定特定文件进行处理
```bash
# 处理特定文件
python3 download_audio.py --files words_001.json words_002.json

# 或者使用短参数
python3 download_audio.py -f words_010.json
```

## 参数说明

- `--status` / `-s`: 显示详细状态（包含所有文件的进度条）
- `--brief` / `-b`: 显示简洁状态（概要信息）
- `--files` / `-f`: 指定要处理的文件名（可以指定多个）
- `--num` / `-n`: 指定要处理的文件数量（默认为1）
- `--rescan` / `-r`: 重新扫描文件目录（添加新文件后使用）

## 音频文件命名规则

- 英式发音：`{单词}_uk.mp3`
- 美式发音：`{单词}_us.mp3`

例如：
- `hello_uk.mp3` - hello的英式发音
- `hello_us.mp3` - hello的美式发音

## 进度管理

脚本会自动创建 `download_progress.json` 文件来记录：
- 每个文件的处理状态
- 已完成的单词数量
- 失败的下载数量
- 整体进度统计

## 安全特性

- 自动跳过已存在的音频文件
- 每10个单词自动保存进度
- 网络请求间有延时，避免频率过高
- 支持断点续传，可以随时中断和继续

## 状态说明

- `pending`: 待处理
- `processing`: 正在处理
- `completed`: 已完成
- `failed`: 处理失败

## TODO状态显示示例

### 详细状态显示
```
======================================================================
🎵 有道词典音频下载器 - TODO进度状态
======================================================================
📊 整体进度:
   📁 文件进度: [██░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 8.3% 2/24 (8.3%)
   🎵 音频进度: [█░░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 4.2% 2000/47764 (4.2%)

📈 详细统计:
   📝 总单词数: 23,882
   🎵 已下载音频: 2,000
   ❌ 下载失败: 15

📋 TODO列表状态:

   ✅ 已完成 (2 个文件):
      📄 words_001.json [████████████████████] 100.0% 1000/1000
         ⏰ 最后更新: 2025-11-02 10:30:15
      📄 words_002.json [████████████████████] 100.0% 1000/1000
         ⏰ 最后更新: 2025-11-02 11:45:22

   🔄 处理中 (1 个文件):
      📄 words_003.json [██████░░░░░░░░░░░░░░░░] 30.0% 300/1000
         ⏰ 最后更新: 2025-11-02 12:10:05

   ⏳ 待处理 (21 个文件):
      ⏳ words_004.json (1000 个单词)
      ⏳ words_005.json (1000 个单词)
      ... (还有 19 个待处理文件)
======================================================================
```

### 简洁状态显示
```
======================================================================
🎵 有道词典音频下载器 - TODO进度状态
======================================================================
📊 整体进度:
   📁 文件进度: [██░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 8.3% 2/24 (8.3%)
   🎵 音频进度: [█░░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 4.2% 2000/47764 (4.2%)

📈 详细统计:
   📝 总单词数: 23,882
   🎵 已下载音频: 2,000
   ❌ 下载失败: 15

📋 TODO列表状态:

   ✅ 已完成 (2 个文件):
      📄 words_001.json (1000/1000 - 100.0%)
      📄 words_002.json (1000/1000 - 100.0%)

   ⏳ 待处理 (21 个文件):
      ⏳ words_004.json (1000 个单词)
      ⏳ words_005.json (1000 个单词)
      ... (还有 19 个待处理文件)
======================================================================
```

## 注意事项

1. 请确保网络连接稳定
2. 下载过程中可以随时中断（Ctrl+C），进度会被保存
3. 如果遇到网络错误，可以重新运行脚本继续下载
4. 音频文件较小，但总数量较多，请确保有足够的磁盘空间
5. 建议分批下载，避免对服务器造成过大压力

## 故障排除

如果遇到问题，可以：
1. 检查网络连接
2. 查看 `download_progress.json` 文件了解详细状态
3. 删除 `download_progress.json` 重新开始（会丢失之前的进度）
4. 检查 `audio_downloads` 目录的磁盘空间